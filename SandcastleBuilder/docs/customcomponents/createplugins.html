<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Creating a Build Process Plug-In </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Creating a Build Process Plug-In ">
      
      
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/EWSoftware/SHFB/blob/main/Documentation/SandcastleBuilder/docfx/docs/customcomponents/createplugins.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">


      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../.././">
            <img id="logo" class="svg" src="../../images/Sandcastle.jpg" alt="Sandcastle Help File Builder Documentation">
            Sandcastle Help File Builder Documentation
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="creating-a-build-process-plug-in">Creating a Build Process Plug-In</h1>

<h2 id="DefineConfig"> Defining the Plug-In Configuration</h2>
<p>The first step is to determine what items will appear in the plug-in configuration.  The
configuration is stored as an XML fragment in the help file builder project file.  The root node is always <code>configuration</code>.  Define your own elements to contain the plug-in configuration that will
be nested within the root element.  When first added to a project, the configuration will be empty.  Your plug-in
should use appropriate default values as needed.  It is possible that a plug-in will have no configurable
elements.  In that case, there is nothing to add to the default configuration.  Below is an example of a
configuration that is passed to a plug-in.</p>
<pre><code class="lang-xml">&lt;configuration deleteAfterDeploy=&quot;true&quot;&gt;
    &lt;deploymentLocation id=&quot;help1x&quot; location=&quot;..\..\SHFB\Deploy\Help\&quot;&gt;
        &lt;userCredentials useDefault=&quot;true&quot; userName=&quot;&quot; password=&quot;&quot; /&gt;
        &lt;proxyCredentials useProxy=&quot;false&quot; proxyServer=&quot;&quot;&gt;
            &lt;userCredentials useDefault=&quot;true&quot; userName=&quot;&quot; password=&quot;&quot; /&gt;
        &lt;/proxyCredentials&gt;
    &lt;/deploymentLocation&gt;
    &lt;deploymentLocation id=&quot;help2x&quot; location=&quot;&quot;&gt;
        &lt;userCredentials useDefault=&quot;true&quot; userName=&quot;&quot; password=&quot;&quot; /&gt;
        &lt;proxyCredentials useProxy=&quot;false&quot; proxyServer=&quot;&quot;&gt;
            &lt;userCredentials useDefault=&quot;true&quot; userName=&quot;&quot; password=&quot;&quot; /&gt;
        &lt;/proxyCredentials&gt;
    &lt;/deploymentLocation&gt;
    &lt;deploymentLocation id=&quot;helpViewer&quot; location=&quot;&quot; renameMSHA=&quot;false&quot;&gt;
        &lt;userCredentials useDefault=&quot;true&quot; userName=&quot;&quot; password=&quot;&quot; /&gt;
        &lt;proxyCredentials useProxy=&quot;false&quot; proxyServer=&quot;&quot;&gt;
            &lt;userCredentials useDefault=&quot;true&quot; userName=&quot;&quot; password=&quot;&quot; /&gt;
        &lt;/proxyCredentials&gt;
    &lt;/deploymentLocation&gt;
    &lt;deploymentLocation id=&quot;website&quot; location=&quot;..\WebHelp\SHFB\&quot;&gt;
        &lt;userCredentials useDefault=&quot;true&quot; userName=&quot;&quot; password=&quot;&quot; /&gt;
        &lt;proxyCredentials useProxy=&quot;false&quot; proxyServer=&quot;&quot;&gt;
            &lt;userCredentials useDefault=&quot;true&quot; userName=&quot;&quot; password=&quot;&quot; /&gt;
        &lt;/proxyCredentials&gt;
    &lt;/deploymentLocation&gt;
    &lt;deploymentLocation id=&quot;openXml&quot; location=&quot;&quot;&gt;
        &lt;userCredentials useDefault=&quot;true&quot; userName=&quot;&quot; password=&quot;&quot; /&gt;
        &lt;proxyCredentials useProxy=&quot;false&quot; proxyServer=&quot;&quot;&gt;
            &lt;userCredentials useDefault=&quot;true&quot; userName=&quot;&quot; password=&quot;&quot; /&gt;
        &lt;/proxyCredentials&gt;
    &lt;/deploymentLocation&gt;
&lt;/configuration&gt;
</code></pre>
<h2 id="CreateProject"> Creating the Project</h2>
<p>This section describes how to create and configure the build process plug-in project.  It will
describe the process for a C# project but the steps should be fairly similar for a VB.NET project with a few
differences in the configuration option titles.</p>
<h3 id="create-the-plug-in-project">Create the Plug-In Project</h3>
<ol>
<li><p>In Visual Studio, select the <strong>New Project</strong> option.  In the <strong>New Project</strong>
dialog box, select the C# or VB.NET language, and then select the <strong>Documentation</strong> subcategory.  Select
the <strong>Sandcastle Help File Builder Plug-In</strong> template, give it a name and click <strong>OK</strong> to create it.
Once it has been created, right click on the project and select <strong>Properties</strong>.</p>
</li>
<li><p>In the <strong>Application</strong> tab, set the assembly name and default namespace as you see fit.</p>
</li>
<li><p>In the <strong>Package</strong> tab, set the NuGet package properties.</p>
</li>
<li><p>By default, the Debug project properties are set to use the standalone GUI for debugging
which will help you see if the component can be located, that the configuration form is working if you created
one for the component, and that it is working within the build as expected.  See the <a href="debuggingcomponents.html">Debugging Components and Plug-Ins</a> for some special requirements when debugging
components and plug-ins.</p>
<div class="TIP">
<h5>Tip</h5>
<p>Using the standalone GUI as the host is easier than using Visual Studio as the package
locks the assemblies once the help file builder project has loaded them for use and you will not be able to
rebuild them.  Shutting down the standalone GUI frees the assemblies so that you can rebuild them and start a
new debugging session.</p>
<p>In the help file builder project that you use to test your plug-in, set the project's <code>Component Path</code> property to the folder containing your build component's assembly.  If
you have opened the project's <strong>Components</strong> property page before setting the component path, you may need
to close and reopen the project in order for it to discover your build component assembly.</p>
</div>
</li>
<li><p>Optionally, select the <strong>Signing</strong> tab and check the &quot;Sign the assembly&quot; checkbox.
Select &quot;&lt;New...&gt;&quot; from the &quot;Choose a strong name key file&quot; dropdown, enter a filename, and click OK to
create the key file.  You can protect the key file with a password if you like or uncheck the option to create
one without a password.</p>
</li>
</ol>
<h2 id="Template"> The Plug-In Template Class</h2>
<p>You are now ready to edit the plug-in class itself.  See the comments in the template class for
information on how to get started.  Some general information is given below.  Note that multiple plug-ins can
reside within the same assembly.  Add new class files to the project and implement the necessary methods as
described below and as shown in the template class.</p>
<p>The plug-in is derived from the <a class="xref" href="../../api/Sandcastle.Core.PlugIn.IPlugIn.html">Sandcastle.Core.PlugIn.IPlugIn</a>
interface and consists of a few properties and methods that you must implement.  These are described below.
Review the code for &quot; <code>TODO:</code> &quot; comments to find sections that need attention such as
setting the plug-in's ID, defining the execution points, etc.  If you followed the steps in the <strong>Creating the Project</strong> section, you can run the project and debug it by setting
breakpoints in the plug-in's code.  As noted above, set the test project's <code>Component Path</code>
property to the folder containing the plug-in assembly first.  If necessary, close and reopen the test project
so that it can discover the plug-in.</p>
<h2 id="Metadata"> The Export Attribute Metadata</h2>
<p>The plug-in is a Managed Extensibility Framework (MEF) component.  The <a class="xref" href="../../api/Sandcastle.Core.PlugIn.HelpFileBuilderPlugInExportAttribute.html">HelpFileBuilderPlugInExportAttribute</a>
is used to define the necessary metadata that enables the help file builder to load and use the component.</p>
<h3 id="MetadataId"> Id</h3>
<p>The <code>Id</code> parameter is required and is used to uniquely identify the
plug-in.</p>
<h3 id="MetadataVersion"> Version</h3>
<p>The <code>Version</code> property is optional and allows you to define the plug-in
version displayed in the help file builder property page when the plug-in is selected.</p>
<h3 id="MetadataCopyright"> Copyright</h3>
<p>The <code>Copyright</code> property is optional and allows you to define the
plug-in copyright displayed in the help file builder property page when the plug-in is selected.</p>
<h3 id="MetadataDescription"> Description</h3>
<p>The <code>Description</code> property is optional and allows you to define the
plug-in description displayed in the help file builder property page when the plug-in is selected.</p>
<h3 id="MetadataRunsInPartialBuild"> RunsInPartialBuild</h3>
<p>The <code>RunsInPartialBuild</code> property is optional and allows you to define
whether or not the plug-in runs during a partial build.  Partial builds occur when generating the reflection data
for the namespace comments and API filter editor dialogs.  In such cases, the plug-in may not be needed.  If this
property returns false, the default, the plug-in is omitted which can speed up the partial build.  Set it to true
if your plug-in adds information needed for the reflection data or namespace comments.</p>
<h3 id="MetadataIsHidden"> IsHidden</h3>
<p>The <code>IsHidden</code> property is optional and allows you to define
whether or not the plug-in is hidden and does not appear on the project property page.  If false, the default,
the plug-in will appear on the property page.  If true, the property page will not list it as one that can
be added to the project.  This is useful for presentation style dependency plug-ins that have no configurable
elements and thus do not need to be manually added to the project to override settings.</p>
<h2 id="Interface"> The Plug-In Interface</h2>
<p>The interface consists of one property and four methods.</p>
<h3 id="ExecutionPoints"> ExecutionPoints</h3>
<p>The <code>ExecutionPoints</code> property is probably the most important member of
the interface.  It returns a collection of <a class="xref" href="../../api/Sandcastle.Core.PlugIn.ExecutionPoint.html">ExecutionPoint</a>
objects that define at which steps in the build process the plug-in should be ran.  Execution points can be set
to run before and/or after a build step to supplement the default processing or they can be set to run instead of
the build step to completely suppress or replace the default processing.  See the <a class="xref" href="../../api/Sandcastle.Core.BuildEngine.BuildStep.html">BuildStep</a>
enumeration for a list of the defined build steps.</p>
<p>Each execution point can be assigned a priority.  The execution priority is used to determine
the order in which the plug-ins will be executed.  Those with a higher priority value will be executed before
those with a lower value.  Those with an identical priority may be executed in any order within their group.  If
not specified, a default priority of 1,000 is used.</p>
<h3 id="Initialize"> Initialize</h3>
<p>The <code>Initialize</code> method is used to initialize the plug-in at the start
of the build process.  It is passed a reference to the current <a class="xref" href="../../api/Sandcastle.Core.BuildEngine.IBuildProcess.html">IBuildProcess</a>
and an XPath navigator containing the plug-in configuration.  You should cache a copy of the build process
reference for use during execution as it contains many properties and methods that you will find useful.</p>
<h3 id="Execute"> Execute</h3>
<p>The <code>Execute</code> method is called to perform the plug-in processing during
the relevant build steps.  It is passed an <a class="xref" href="../../api/Sandcastle.Core.PlugIn.ExecutionContext.html">Sandcastle.Core.PlugIn.ExecutionContext</a>
object that defines the current execution context.  If your plug-in determines that it does not need to run, it
should set the <a class="xref" href="../../api/Sandcastle.Core.PlugIn.ExecutionContext.Executed.html#Sandcastle_Core_PlugIn_ExecutionContext_Executed">Sandcastle.Core.PlugIn.ExecutionContext.Executed</a>
property to false.  This is especially important for plug-ins with the <code>InsteadOf</code>
behavior. If none run, the default processing will occur.</p>
<h3 id="Dispose"> Finalizer and Dispose</h3>
<p>The <code>Dispose</code> method can be used to dispose of any resources used during
the build process.  If you do not have any resources that need to be disposed of, this method can be left as
it is and the finalizer method can be removed.</p>
<h2 id="ExecNotes"> Execution Notes</h2>
<p>There are certain conditions to be aware of when choosing and coding the execution behavior for
your plug-in.</p>
<ul>
<li><p>The earliest execution point for a plug-in is the <code>After</code> behavior with
the <code>Initializing</code> step.</p>
</li>
<li><p>The <code>Before</code> behavior cannot be used with the <code>Initializing</code>, <code>Canceled</code>, or <code>Failed</code> steps.</p>
</li>
<li><p>The <code>InsteadOf</code> behavior cannot be used with the <code>Initializing</code>, <code>Completed</code>, <code>Canceled</code>, or <code>Failed</code> steps.</p>
</li>
<li><p>The <code>InsteadOf</code> behavior always takes precedence.  The build process
will not call any plug-ins with <code>Before</code> or <code>After</code> behavior for
the step if an <code>InsteadOf</code> plug-in runs.  As such, it is up to the plug-in with the <code>InsteadOf</code> behavior to call the <a class="xref" href="../../api/Sandcastle.Core.BuildEngine.IBuildProcess.ExecuteBeforeStepPlugIns.html#Sandcastle_Core_BuildEngine_IBuildProcess_ExecuteBeforeStepPlugIns">IBuildProcess.ExecuteBeforeStepPlugIns()</a>
and <a class="xref" href="../../api/Sandcastle.Core.BuildEngine.IBuildProcess.ExecuteAfterStepPlugIns.html#Sandcastle_Core_BuildEngine_IBuildProcess_ExecuteAfterStepPlugIns">IBuildProcess.ExecuteAfterStepPlugIns()</a>
methods to run them if needed.</p>
</li>
<li><p>If the build step involves creating, modifying, or deleting a non-script file or folder, the <code>Before</code> behavior is always executed prior to creating/modifying/deleting the file or
folder.  Use the <code>After</code> behavior if you need to guarantee that the file or folder exists
or you do not want your version overwritten.  The exceptions to this rule are MSBuild project files
(<em>*.proj</em>) and <em>MRefBuilder.config</em> which are always created prior to
running the <code>Before</code> behavior plug-ins.  This allows you to modify the script files prior
to them being ran.</p>
</li>
<li><p>If the build step involves creating, modifying, or deleting a script file or folder and the <code>InsteadOf</code> behavior is used, the plug-in is responsible for creating the script
file/folder.  All normal processing involving the file/folder including its creation is skipped.</p>
</li>
<li><p>The <code>GenerateHelpFormatTableOfContents</code>, <code>GenerateHelpFileIndex</code>, <code>GenerateHelpProject</code>, <code>UpdateTableOfContents</code>, and <code>CompilingHelpFile</code> steps will run
once for each help file format selected.  You can use the <a class="xref" href="../../api/Sandcastle.Core.BuildEngine.IBuildProcess.CurrentFormat.html#Sandcastle_Core_BuildEngine_IBuildProcess_CurrentFormat">IBuildProcess.CurrentFormat</a>
property to determine the current help file format being built in order to skip or alter the plug-in's processing
based on the help file format.</p>
</li>
<li><p>Be aware that the HTML Help 1 index and table of contents files and the website table of
contents file are actually generated as part of the <code>ExtractHtmlInfo</code> step.  However, the
before and after plug-in behaviors for the index and table of contents steps in each of those formats will still
be executed.</p>
</li>
</ul>
<h2 id="see-also">See Also</h2>
<h4 id="concepts">Concepts</h4>
<ul>
<li><a href="creatingcustomcomponents.html">Creating Custom Components</a></li>
<li><a href="../plugins/plugins.html">Build Process Plug-Ins</a></li>
</ul>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/EWSoftware/SHFB/blob/main/Documentation/SandcastleBuilder/docfx/docs/customcomponents/createplugins.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          [v{@HelpFileVersion}] Copyright \xA9 2006-2025, Eric Woodruff, All rights reserved
        </div>
        <div class="flex-fill text-end">
          <span>Made with <a href="https://dotmake.build/docfx-plus/">docfx-plus</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
