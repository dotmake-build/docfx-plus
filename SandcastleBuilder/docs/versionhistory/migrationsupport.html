<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Component Migration Support </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Component Migration Support ">
      
      
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/EWSoftware/SHFB/blob/main/Documentation/SandcastleBuilder/docfx/docs/versionhistory/migrationsupport.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">


      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../.././">
            <img id="logo" class="svg" src="../../images/Sandcastle.jpg" alt="Sandcastle Help File Builder Documentation">
            Sandcastle Help File Builder Documentation
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="component-migration-support">Component Migration Support</h1>

<p>This topic provides information on migrating build components, plug-ins, presentation styles, and
syntax generators built against v2021.4.9.0 and earlier to the latest release that supports .NET Core and
deploying the components as NuGet packages.  Presentation styles also underwent a complete rewrite in
version 2022.8.14.0.  However, you may be able to replace your presentation style with simpler build components
or plug-ins rather than reimplementing an entire presentation style.  Further changes made after version
2025.3.22.0 made the <em>EWSoftware.SandcastleBuilder.Utils</em> NuGet package obsolete.</p>
<h2 id="Post20250322"> Updating Projects For Use With v2025.9.30.0 and Later</h2>
<p>The <em>EWSoftware.SandcastleBuilder.Utils</em> NuGet package should not be used after
version 2025.3.22.0.  All code in it was moved to the <em>EWSoftware.Sandcastle.Core</em> package and
other internal assemblies.  To update projects using the obsolete package, simply remove it and update the
package reference for <em>EWSoftware.Sandcastle.Core</em> to the latest release.</p>
<p>Once the package references have been updated, you will have to update the imported namespaces in
the plug-in and component code.  Replace any <code>SandcastleBuilder.Utils</code> namespace
references with ones from <code>Sandcastle.Core</code> such as <code>Sandcastle.Core.BuildAssembler</code>, <code>Sandcastle.Core.BuildAssembler.BuildComponent</code>, <code>Sandcastle.Core.BuildEngine</code>, <code>Sandcastle.Core.PlugIn</code>
and <code>Sandcastle.Core.Project</code>.  You will also need to replace references to types
such as <code>BuildProcess</code> and <code>SandcastleProject</code> with their
equivalent interfaces such as <code>IBuildProcess</code> and <code>ISandcastleProject</code>.</p>
<h2 id="QuickUpdate"> Quick Updates for MSBuild Support Only</h2>
<p>Some quick updates can be made to get an existing component working with the new release without
having to recreate the project with the restriction that they will only work with MSBuild.  For .NET Core builds,
the projects will need to be recreated as described in the sections below.  Make the following changes as needed
based on the project type:</p>
<ul>
<li><p>Remove any references to <em>Sandcastle.Core</em> and <em>SandcastleBuilder.Utils</em> and replace them with a NuGet package references to <em>EWSoftware.Sandcastle.Core</em>.  Use the latest release available.  Note that the version may
not match the latest release of the help file builder as the package version for these only changes when there
are breaking changes to the API.</p>
</li>
<li><p>For presentation styles, refer to the section below for additional changes that are required
due to change in the API.</p>
</li>
<li><p>Remove the <code>IsConfigurable</code> property from the build component and
plug-in export attributes.</p>
</li>
<li><p>If configurable, remove the <code>ConfigureComponent</code> method from build
components and the <code>ConfigurePlugIn</code> method from plug-ins.  Save the code though as you
will need to move it to the configuration forms when you add a new MEF editor factory class below.</p>
</li>
<li><p>For plug-ins, change the type on the <code>Initialize</code> method'sconfigurationparameter from <code>XPathNavigator</code>
to <code>XElement</code>.  It will be necessary to rework the initialization code to work with the
new parameter type.</p>
</li>
<li><p>For configurable build components and plug-ins, add an editor factory class to the
configuration editor form similar to the following examples.  The first is for a plug-in, the second is for a
build component.</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It is essential that the ID specified in the export attribute matches the ID on the component
or plug-in's export attribute exactly.  This is how the IDEs will match the editor component to the related
build component or plug-in.</p>
<p>Also note that the <code>EditConfiguration</code> methods now return true if the
configuration was edited or false if it was not rather than the new configuration.  If changes are made to the
configuration, they should be made directly to the passed in XML element.</p>
</div>
<pre><code class="lang-cs">using Sandcastle.Core.BuildAssembler;
using Sandcastle.Core.BuildAssembler.BuildComponent;

#region Plug-in configuration editor factory for MEF
//=====================================================================

/// &lt;summary&gt;
/// This allows editing of the plug-in configuration
/// &lt;/summary&gt;
[PlugInConfigurationEditorExport(&quot;TODO: Put your plug-in ID here&quot;)]
public sealed class PlugInEditorFactory : IPlugInConfigurationEditor
{
    /// &lt;inheritdoc /&gt;
    public bool EditConfiguration(SandcastleProject project, XElement configuration)
    {
        // TODO: Add code to invoke the editor dialog.
        //using (var dlg = new WindowsFormsExampleConfigDlg(configuration))
        //{
        //    return dlg.ShowDialog() == DialogResult.OK;
        //}
    }
}
#endregion

#region Build component configuration editor factory for MEF
//=====================================================================

/// &lt;summary&gt;
/// This allows editing of the build component configuration
/// &lt;/summary&gt;
[ConfigurationEditorExport(&quot;TODO: Put your build component ID here&quot;)]
public sealed class BuildComponentEditorFactory : IConfigurationEditor
{
    /// &lt;inheritdoc /&gt;
    public bool EditConfiguration(XElement configuration, CompositionContainer container)
    {
        // TODO: Add code to invoke the editor dialog.
        //using (var dlg = new WindowsFormsExampleConfigDlg(configuration))
        //{
        //    return dlg.ShowDialog() == DialogResult.OK;
        //}
    }
}
#endregion
</code></pre>
</li>
</ul>
<h2 id="RecreateProjects"> Support for MSBuild and .NET Core Builds</h2>
<p>Starting with version v2021.11.7.0, all component projects use an SDK format project and contain
the necessary properties to generate a NuGet package when built.  This allows them to be shared publicly on
NuGet.org or privately with a local repository.  So that they are platform independent and work with both MSBuild
and the dotnet tool, the projects target .NET Standard 2.0.  Support for configuration has also been separated
from the component assemblies.  If your component supports configuration within the IDE, create a new project to
host the configuration forms.</p>
<p>It is recommended that you create a new project and import your existing code into the new project
rather than modifying the old project file.  That way, all of the necessary NuGet properties and the build
property file are present and ready to update.  The following sections provide more information on
changes that need to be made to the various component project types.</p>
<div class="WARNING">
<h5>Warning</h5>
<p>If, after creating a project, you rename the assembly created by the project, be sure to rename
the project's <em>.props</em> file found in the <em>.\build</em> folder to match the new
assembly name.  This is required so that the build properties can be found when added to a help file builder
project using NuGet.</p>
</div>
<h2 id="BuildComponents"> Migrating Build Component Projects</h2>
<ul>
<li><p>Create a new project and edit the properties on the project file's Package properties page that
are used to generate the NuGet package for the component.</p>
</li>
<li><p>Import your component's code into the new project to replace the example component.  Some of
the attribute values in the <em>AssemblyInfo.cs</em> file can be put in the project's package
properties instead (title, description, company).</p>
</li>
<li><p>In the MEF component factory class, remove the <code>IsConfigurable</code> property
from the attribute metadata.</p>
</li>
<li><p>If the component is configurable, remove the <code>ConfigureComponent</code>
method.  To support configuration, you will need to create a new project using the <strong>Build Component/Plug-InConfiguration Editor</strong> template project.  See the <a href="../customcomponents/createconfiguiproject.html">Creating a Configuration UI Project</a>
topic for more information.</p>
</li>
</ul>
<h2 id="PlugIns"> Migrating Help File Builder Plug-In Projects</h2>
<ul>
<li><p>Create a new project and edit the properties on the project file's Package properties page that
are used to generate the NuGet package for the plug-in.</p>
</li>
<li><p>Import your plug-in's code into the new project to replace the example plug-in.  Some of
the attribute values in the <em>AssemblyInfo.cs</em> file can be put in the project's package
properties instead (title, description, company).</p>
</li>
<li><p>In the MEF component factory class, remove the <code>IsConfigurable</code> property
from the attribute metadata.</p>
</li>
<li><p>If the component is configurable, remove the <code>ConfigureComponent</code>
method.  To support configuration, you will need to create a new project using the <strong>Build Component/Plug-InConfiguration Editor</strong> template project.  See the <a href="../customcomponents/createconfiguiproject.html">Creating a Configuration UI Project</a>
topic for more information.</p>
</li>
<li><p>In the plug-in's <code>Initialize</code> method, change the type on theconfigurationparameter from <code>XPathNavigator</code>
to <code>XElement</code>.  It will be necessary to rework the initialization code to work with the
new parameter type.</p>
</li>
</ul>
<h2 id="PresentationStyles"> Migrating Presentation Style Projects</h2>
<p>Starting with version 2022.8.14.0, presentation styles are implemented using a code-based API rather than
XSL transformations.  This makes them much easier to extend and modify compared to prior releases.  If you
created your own presentation style in the past to make adjustments to how the topics were rendered or to add or
remove handling for certain sections or elements, it is entirely likely that you will not need to create a whole
new presentation style going forward.  Instead, you should be able to implement just those parts that you need to
modify using standard help file builder plug-ins to adjust how the topics are rendered with selected presentation
style regardless of which one is selected.  See the <a href="../customcomponents/custompresentationstyle.html">Creating a Presentation Style Component</a>
for more information.</p>
<p>A new project template and more information on creating a presentation style using the new API will
be provided in a future release.</p>
<h2 id="SyntaxGenerators"> Migrating Syntax Generator Projects</h2>
<ul>
<li><p>Create a new project and edit the properties on the project file's Package properties page that
are used to generate the NuGet package for the syntax generator.</p>
</li>
<li><p>Import your syntax generator's code and other supporting files into the new project to
replace the example syntax generator.  Some of the attribute values in the <em>AssemblyInfo.cs</em>
file can be put in the project's package properties instead (title, description, company).</p>
<p>Note that the syntax generator's <code>IsConfigurable</code> property is still
supported and should be left alone if set as it is used by the syntax component's configuration dialog rather
than a configuration form defined within this project.</p>
</li>
</ul>
<h2 id="see-also">See Also</h2>
<h4 id="concepts">Concepts</h4>
<ul>
<li><a href="versionhistory.html">Version History</a></li>
</ul>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/EWSoftware/SHFB/blob/main/Documentation/SandcastleBuilder/docfx/docs/versionhistory/migrationsupport.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          [v{@HelpFileVersion}] Copyright \xA9 2006-2025, Eric Woodruff, All rights reserved
        </div>
        <div class="flex-fill text-end">
          <span>Made with <a href="https://dotmake.build/docfx-plus/">docfx-plus</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
